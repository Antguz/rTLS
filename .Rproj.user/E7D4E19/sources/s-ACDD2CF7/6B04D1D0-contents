#' @import dplyr
#'
#' @title Subset neighboring points based on da istance
#'
#' @description Subset neighboring points based on a distance.
#'
#' @param x An object of class  \code{neighborhood}.
#' @param new_distance A numeric vector that swhich specifies the new distance to subset.
#'
#' @return An object of class "neighborhood" with a list per point of the neighboring points.
#' @author J. Antonio Guzman Q. and Ronny Hernandez
#'
#' @examples
#' data("pc_tree")
#'
#' ###Subset neighboring points from 0.2 to 0.1
#' dis <- neighborhood(pc_tree, method = "distance", radius = 0.2, parallel = FALSE)
#' sub_distance(dis, new_distance = 0.1)
#'
#' @export
sub_distance <- function(x, new_distance) {
  sub <- llply(dis,
    .fun = function(x, new_distance) {x <- x[x[, 4] <= new_distance,]},
     new_distance = new_distance,
    .inform = FALSE,
    .parallel = FALSE)
 return(sub)
}
